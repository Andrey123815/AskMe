# Домашнее задание 5

## Загрузка картинок и обработка AJAX запросов

Целью домашнего задания является добавления функционала аватарок (загрузка картинок) и обработка AJAX запросов (лайки).

### 1. Загрузка картинок
Для хранения картинок нужно использовать встроенные инструменты Django, а именно [django.db.models.ImageField](https://docs.djangoproject.com/en/2.0/ref/models/fields/#imagefield) для хранения URL картинки в модели и [django.forms.ImageField](https://docs.djangoproject.com/en/2.0/ref/forms/fields/#imagefield) для описания поля в форме. Django хранит загруженные файлы на диске в директории **settings.MEDIA_ROOT**. В нашем случае в настройке **settings.MEDIA_URL** и в конфиге nginx должен быть прописать путь к директории **media** вашего проекте. Для отображения аватарки пользователя достаточно будет вставить в тег **\<img src="{{ MEDIA_URL }}{{ user.avatar }}"\>**.

### 2. Необходимыe AJAX запросы
- Лайк (дизлайк) вопроса. На сервер передаются параметры: id вопроса, тип (лайк / дизлайк). Возвращается: новый рейтинг вопроса или код ошибки.
- Галочка правильный ответ. На сервер передается ID вопроса и ID правильного ответа. Необходимо проверить что только автор вопроса может выбирать правильный ответ.

### 3. Обработка AJAX запросов
Так как отображение ошибок при AJAX запросах затруднительно, желательно не дать (на уровне интерфейса) возможности пользователю делать неправильные запросы. Например, если пользователь уже лайкал данный вопрос - то скрыть или отключить кнопку лайка. Скрыть выбор правильного ответа для не авторов.

В отличие от остальных страниц, в ответ на AJAX запрос сервер должен возвращать JSON документ. Для этого необходимо создавать объект **django.http.HttpResponse** самостоятельно с **Content-Type: application/json** и соответсвующим телом ответа, либо воспользоваться вспомогательным [объектом django.http.JsonResponse](https://docs.djangoproject.com/en/2.0/ref/request-response/#jsonresponse-objects).

Для отправки AJAX запросов в браузере можно использовать jQuery, воспользовавшись каким-либо [туториалом](http://jquery.page2page.ru/index.php5/Ajax_%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81_%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D0%BE%D0%BC_POST).
Необходимо учесть, что Django ожидает получить с каждым запросом [csrf_token](https://docs.djangoproject.com/en/2.0/ref/csrf/#ajax), поэтому необходимо добавить его
данные каждого AJAX запроса.

### 4. Полезные ссылки
- Документация по [загрузке файлов в Django](https://docs.djangoproject.com/en/2.0/ref/forms/fields/#imagefield);
- Документация по [работе со статическими файлам в Django](https://docs.djangoproject.com/en/2.0/howto/static-files/);
- Неплохой туториал по [связке django + jquery + ajax](https://realpython.com/blog/python/django-and-ajax-form-submissions/);
- Про [CSRF в Django](https://docs.djangoproject.com/en/2.0/ref/csrf/).
